<!DOCTYPE html>
<html lang="ru" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0d6efd">
    <meta name="msapplication-navbutton-color" content="#0d6efd">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>{% block title %}–ú–æ–±–∏–ª—å–Ω–∞—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="manifest" href="/static/manifest.json">
    {% block styles %}{% endblock %}
    <style>
        :root {
            --primary-color: #0d6efd;
            --secondary-color: #6c757d;
            --success-color: #198754;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #0dcaf0;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --border-radius: 0.75rem;
            --box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            --box-shadow-lg: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }

        [data-bs-theme="dark"] {
            --primary-color: #0d6efd;
            --light-color: #212529;
            --dark-color: #f8f9fa;
            --box-shadow: 0 0.125rem 0.25rem rgba(255, 255, 255, 0.075);
            --box-shadow-lg: 0 0.5rem 1rem rgba(255, 255, 255, 0.15);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            padding-bottom: env(safe-area-inset-bottom);
            padding-top: env(safe-area-inset-top);
        }

        .navbar {
            box-shadow: var(--box-shadow);
            padding: 0.75rem 0;
            position: sticky;
            top: 0;
            z-index: 1030;
        }

        .navbar-brand {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .logo-svg {
            width: 32px;
            height: 32px;
            margin-right: 0.5rem;
            color: currentColor;
        }

        .card {
            border: none;
            box-shadow: var(--box-shadow);
            border-radius: var(--border-radius);
            transition: all 0.2s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-lg);
        }

        .btn {
            border-radius: var(--border-radius);
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            transition: all 0.2s ease;
        }

        .btn-lg {
            padding: 1rem 2rem;
            font-size: 1.1rem;
        }

        .form-control, .form-select {
            border-radius: var(--border-radius);
            border: 2px solid transparent;
            background-color: var(--bs-body-bg);
            transition: all 0.2s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
        }

        .scanner-input {
            font-size: 1.2rem;
            padding: 1rem;
            font-family: 'Courier New', monospace;
        }

        .barcode-item {
            border-left: 4px solid var(--primary-color);
            background-color: rgba(13, 110, 253, 0.05);
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            transition: all 0.2s ease;
        }

        .barcode-item:hover {
            background-color: rgba(13, 110, 253, 0.1);
        }

        .theme-toggle {
            border: none;
            background: none;
            color: inherit;
            font-size: 1.2rem;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .theme-toggle:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .stats-card {
            text-align: center;
            padding: 1.5rem;
        }

        .stats-number {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1;
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ */
        .navbar .btn-outline-light {
            border-color: rgba(255, 255, 255, 0.5);
            color: rgba(255, 255, 255, 0.9);
            transition: all 0.2s ease;
        }

        .navbar .btn-outline-light:hover {
            border-color: rgba(255, 255, 255, 0.8);
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* –°—Ç–∞—Ä–∞—è –Ω–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è - —Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        .mobile-nav {
            display: none !important;
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è 2340x1080 */
        @media (max-width: 768px) {
            .container {
                padding: 0.5rem;
                max-width: 100%;
            }
            
            .card {
                margin-bottom: 0.75rem;
                border-radius: 0.5rem;
            }
            
            .btn {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }
            
            .btn-lg {
                padding: 1rem 1.5rem;
                font-size: 1rem;
            }
            
            .navbar-brand {
                font-size: 0.9rem;
            }
            
            .logo-svg {
                width: 24px;
                height: 24px;
            }
            
            .stats-number {
                font-size: 1.8rem;
            }
            
            main {
                padding-bottom: 1rem;
                margin-top: 1rem;
            }
            
            .table-responsive {
                font-size: 0.85rem;
            }



            /* –°–∫—Ä—ã–≤–∞–µ–º –Ω–∏–∂–Ω—é—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é */
            .mobile-nav {
                display: none !important;
            }

            /* –£–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
            .row {
                margin-left: -0.25rem;
                margin-right: -0.25rem;
            }

            .col, .col-1, .col-2, .col-3, .col-4, .col-5, .col-6, .col-7, .col-8, .col-9, .col-10, .col-11, .col-12 {
                padding-left: 0.25rem;
                padding-right: 0.25rem;
            }
        }

        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è 2340x1080 */
        @media (min-width: 400px) and (max-width: 500px) {
            .navbar .btn-outline-light {
                padding: 0.4rem 0.6rem;
                font-size: 0.9rem;
            }
        }

        /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è touch-—É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (hover: none) and (pointer: coarse) {
            .btn {
                min-height: 48px;
            }
            
            .form-control, .form-select {
                min-height: 48px;
            }
            
            .nav-link {
                min-height: 48px;
            }

            .theme-toggle {
                min-width: 44px;
                min-height: 44px;
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ */
        .fullscreen-mode .navbar {
            /* –ù–µ —Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é, –∞ –¥–µ–ª–∞–µ–º –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º */
            padding: 0.25rem 0;
            min-height: 50px;
        }
        
        .fullscreen-mode .navbar-brand {
            font-size: 0.9rem;
        }
        
        .fullscreen-mode .theme-toggle {
            padding: 0.25rem;
            font-size: 1rem;
        }
        
        /* –í –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞ */
        .fullscreen-mode .d-md-none .btn:not([title="–í—ã—Ö–æ–¥"]) {
            display: none;
        }
        
        .fullscreen-mode .d-md-none .btn[title="–í—ã—Ö–æ–¥"] {
            background-color: rgba(220, 53, 69, 0.95);
            border-color: rgba(220, 53, 69, 0.95);
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 16px rgba(220, 53, 69, 0.4);
            transform: scale(1.1);
            transition: all 0.3s ease;
        }
        
        .fullscreen-mode .d-md-none .btn[title="–í—ã—Ö–æ–¥"]:hover {
            background-color: rgba(220, 53, 69, 1);
            border-color: rgba(220, 53, 69, 1);
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.5);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞ –≤ –≤–µ—Ä—Ö–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        .navbar .btn-outline-danger:hover {
            background-color: #dc3545;
            border-color: #dc3545;
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        .fullscreen-mode .d-md-none .btn[title="–í—ã—Ö–æ–¥"]:hover {
            background-color: rgba(220, 53, 69, 1);
            border-color: rgba(220, 53, 69, 1);
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.5);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        .fullscreen-mode .d-md-none .btn[title="–í—ã—Ö–æ–¥"]:active {
            transform: scale(1.05);
            box-shadow: 0 4px 16px rgba(220, 53, 69, 0.4);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        .fullscreen-mode .d-md-none .btn[title="–í—ã—Ö–æ–¥"]:focus {
            outline: none;
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        .fullscreen-mode .d-md-none .btn[title="–í—ã—Ö–æ–¥"]:focus-visible {
            outline: none;
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        .fullscreen-mode .d-md-none .btn[title="–í—ã—Ö–æ–¥"]:focus-within {
            outline: none;
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
        }
        

        
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞ */
        .btn-outline-danger {
            border-width: 2px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-outline-danger:hover {
            background-color: #dc3545;
            border-color: #dc3545;
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞ –≤ –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        .mobile-nav .nav-link.text-danger:hover {
            background-color: rgba(220, 53, 69, 0.1);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.2);
        }
        




        .fullscreen-mode main {
            margin-top: 0;
            padding-top: 0;
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ */
        .fullscreen-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.5rem;
            border-radius: 50%;
            z-index: 9999;
            display: none;
            cursor: pointer;
        }

        .fullscreen-mode .fullscreen-indicator {
            display: block;
        }

        /* PWA —Ä–µ–∂–∏–º - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        .pwa-mode {
            /* –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º –≤ PWA */
            overflow: hidden;
        }
        
        .pwa-mode .fullscreen-indicator {
            display: none !important;
        }
        
        .pwa-mode .navbar {
            /* –í PWA —Ä–µ–∂–∏–º–µ –¥–µ–ª–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é –µ—â–µ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–π */
            padding: 0.15rem 0;
            min-height: 45px;
        }
        
        .pwa-mode .navbar-brand {
            font-size: 0.8rem;
        }
        
        .pwa-mode .theme-toggle {
            padding: 0.2rem;
            font-size: 0.9rem;
        }
        

        
        /* –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –≤ PWA */
        .pwa-mode button[onclick="toggleFullscreen()"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            width: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            border: none !important;
            position: absolute !important;
            left: -9999px !important;
        }
        
        .pwa-mode .theme-toggle[onclick="toggleFullscreen()"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            width: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            border: none !important;
            position: absolute !important;
            left: -9999px !important;
        }
        
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ */
        .pwa-mode button[onclick*="toggleFullscreen"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            width: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            border: none !important;
            position: absolute !important;
            left: -9999px !important;
        }
        
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ */
        .pwa-mode .theme-toggle[onclick*="toggleFullscreen"],
        .pwa-mode button[onclick*="toggleFullscreen"],
        .pwa-mode .fullscreen-toggle {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            width: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            border: none !important;
            position: absolute !important;
            left: -9999px !important;
            clip: rect(0, 0, 0, 0) !important;
        }
        
        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å —Ç–æ—á–Ω—ã–º onclick="toggleFullscreen()" */
        .pwa-mode button[onclick="toggleFullscreen()"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            width: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            border: none !important;
            position: absolute !important;
            left: -9999px !important;
            clip: rect(0, 0, 0, 0) !important;
            pointer-events: none !important;
        }
        
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ */
        .pwa-mode .theme-toggle[onclick*="toggleFullscreen"],
        .pwa-mode button[onclick*="toggleFullscreen"],
        .pwa-mode .fullscreen-toggle,
        .pwa-mode .fullscreen-btn {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            width: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            border: none !important;
            position: absolute !important;
            left: -9999px !important;
            clip: rect(0, 0, 0, 0) !important;
            pointer-events: none !important;
            font-size: 0 !important;
            line-height: 0 !important;
        }
        
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å—é */
        .pwa-mode .navbar .container .d-flex .theme-toggle[onclick="toggleFullscreen()"],
        .pwa-mode .navbar .container .d-flex .theme-toggle[onclick*="toggleFullscreen"],
        .pwa-mode .navbar .container .d-flex button[onclick="toggleFullscreen()"],
        .pwa-mode .navbar .container .d-flex button[onclick*="toggleFullscreen"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            width: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            border: none !important;
            position: absolute !important;
            left: -9999px !important;
            clip: rect(0, 0, 0, 0) !important;
            pointer-events: none !important;
            font-size: 0 !important;
            line-height: 0 !important;
            z-index: -9999 !important;
        }
        
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å—é */
        .pwa-mode .navbar .container .d-flex .theme-toggle[onclick="toggleFullscreen()"],
        .pwa-mode .navbar .container .d-flex .theme-toggle[onclick*="toggleFullscreen"],
        .pwa-mode .navbar .container .d-flex button[onclick="toggleFullscreen()"],
        .pwa-mode .navbar .container .d-flex button[onclick*="toggleFullscreen"],
        .pwa-mode .navbar .container .d-flex .theme-toggle[onclick="toggleFullscreen()"],
        .pwa-mode .navbar .container .d-flex .theme-toggle[onclick*="toggleFullscreen"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            width: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            border: none !important;
            position: absolute !important;
            left: -9999px !important;
            clip: rect(0, 0, 0, 0) !important;
            pointer-events: none !important;
            font-size: 0 !important;
            line-height: 0 !important;
            z-index: -9999 !important;
            transform: scale(0) !important;
            transform-origin: center !important;
        }
        
        /* –í PWA —Ä–µ–∂–∏–º–µ —Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ */
        .pwa-mode .fullscreen-indicator {
            display: none !important;
        }
        
        /* –í PWA —Ä–µ–∂–∏–º–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ */
        .pwa-mode .barcode-list,
        .pwa-mode .barcode-item,
        .pwa-mode .stats-cards,
        .pwa-mode .card {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è PWA —Ä–µ–∂–∏–º–∞ */
        .pwa-mode .container {
            /* –í PWA —Ä–µ–∂–∏–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É */
            max-width: 100%;
            padding-left: 0.5rem;
            padding-right: 0.5rem;
        }
        
        .pwa-mode main {
            /* –í PWA —Ä–µ–∂–∏–º–µ —É–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã */
            margin-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
        
        /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—ã—Ö–æ–¥ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –≤ PWA */
        .pwa-mode.fullscreen-mode {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }
        
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ PWA —Ä–µ–∂–∏–º–µ */
        @media (max-width: 768px) {
            .pwa-mode .navbar {
                padding: 0.1rem 0;
                min-height: 40px;
            }
            
            .pwa-mode .navbar-brand {
                font-size: 0.75rem;
            }
            
            .pwa-mode .btn-sm {
                padding: 0.25rem 0.5rem;
                font-size: 0.8rem;
            }
            
            .pwa-mode .container {
                padding-left: 0.25rem;
                padding-right: 0.25rem;
            }
            
            .pwa-mode main {
                margin-top: 0.25rem;
                padding-bottom: 0.25rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <div class="d-flex align-items-center">
                <img src="/logo" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo-svg" 
                     style="width: 32px; height: 32px; margin-right: 0.5rem; object-fit: contain;">
                <a class="navbar-brand" href="/">
                    {{ locale.get('app_name', '–ú–æ–±–∏–ª—å–Ω–∞—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è') }}
                </a>
            </div>
            
            <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö -->
            {% if user %}
            <div class="d-md-none d-flex align-items-center">
                <a href="/dashboard/{{ user.id }}" class="btn btn-outline-light btn-sm me-2" title="–ì–ª–∞–≤–Ω–∞—è">
                    <i class="bi bi-house"></i>
                </a>
                <a href="/scan/{{ user.id }}" class="btn btn-outline-light btn-sm me-2" title="–°–∫–∞–Ω–µ—Ä" id="scanner-btn">
                    <i class="bi bi-qr-code-scan"></i>
                </a>
                <a href="/" class="btn btn-outline-danger btn-sm me-2" title="–í—ã—Ö–æ–¥" style="border-width: 2px; font-weight: 600;">
                    <i class="bi bi-box-arrow-left"></i>
                </a>
            </div>
            {% endif %}
            
            <div class="d-flex align-items-center">
                <button class="theme-toggle me-2" onclick="toggleFullscreen()" title="–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º">
                    <i class="bi bi-fullscreen" id="fullscreen-icon"></i>
                </button>
                
                <button class="theme-toggle me-2" onclick="toggleTheme()" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                    <i class="bi bi-sun-fill" id="theme-icon"></i>
                </button>
                
                <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–∞ -->
                <div class="dropdown me-3">
                    <button class="theme-toggle dropdown-toggle" type="button" data-bs-toggle="dropdown" title="–Ø–∑—ã–∫">
                        <i class="bi bi-translate"></i>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li>
                            <form method="post" action="/set_language" class="d-inline">
                                <input type="hidden" name="language" value="ru">
                                <button type="submit" class="dropdown-item">
                                    üá∑üá∫ –†—É—Å—Å–∫–∏–π
                                </button>
                            </form>
                        </li>
                        <li>
                            <form method="post" action="/set_language" class="d-inline">
                                <input type="hidden" name="language" value="uk">
                                <button type="submit" class="dropdown-item">
                                    üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
                                </button>
                            </form>
                        </li>
                    </ul>
                </div>
                
                {% if user %}
                <div class="d-flex align-items-center text-white">
                    <i class="bi bi-person-circle me-2"></i>
                    <span class="d-none d-md-inline">{{ user.name }}</span>
                </div>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ -->
    <div class="fullscreen-indicator" onclick="exitFullscreen()" title="–í—ã–π—Ç–∏ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞">
        <i class="bi bi-fullscreen-exit"></i>
    </div>

    <main class="container mt-4 fade-in">
        {% block content %}{% endblock %}
    </main>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ -->
    {% if user %}
    <div class="mobile-nav d-md-block d-none">
        <div class="container">
            <div class="row text-center">
                <div class="col">
                    <a href="/dashboard/{{ user.id }}" class="nav-link">
                        <i class="bi bi-house"></i>
                        <span>–ì–ª–∞–≤–Ω–∞—è</span>
                    </a>
                </div>
                <div class="col">
                    <a href="/scan/{{ user.id }}" class="nav-link">
                        <i class="bi bi-qr-code-scan"></i>
                        <span>–°–∫–∞–Ω–µ—Ä</span>
                    </a>
                </div>
                <div class="col">
                    <a href="/" class="nav-link text-danger fw-bold" style="transition: all 0.3s ease;">
                        <i class="bi bi-box-arrow-left"></i>
                        <span>–í—ã—Ö–æ–¥</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–æ–π
        function toggleTheme() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('theme-icon');
            const currentTheme = html.getAttribute('data-bs-theme');
            
            if (currentTheme === 'dark') {
                html.setAttribute('data-bs-theme', 'light');
                themeIcon.className = 'bi bi-sun-fill';
                localStorage.setItem('theme', 'light');
            } else {
                html.setAttribute('data-bs-theme', 'dark');
                themeIcon.className = 'bi bi-moon-fill';
                localStorage.setItem('theme', 'dark');
            }
        }

        // –£–ª—É—á—à–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–º —Ä–µ–∂–∏–º–æ–º –¥–ª—è Android
        function toggleFullscreen() {
            const fullscreenIcon = document.getElementById('fullscreen-icon');
            const body = document.body;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
            const requestFullscreen = document.documentElement.requestFullscreen ||
                                    document.documentElement.webkitRequestFullscreen ||
                                    document.documentElement.mozRequestFullScreen ||
                                    document.documentElement.msRequestFullscreen;
            
            const exitFullscreen = document.exitFullscreen ||
                                  document.webkitExitFullscreen ||
                                  document.mozCancelFullScreen ||
                                  document.msExitFullscreen;
            
            const fullscreenElement = document.fullscreenElement ||
                                    document.webkitFullscreenElement ||
                                    document.mozFullScreenElement ||
                                    document.msFullscreenElement;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
            const isAndroid = /Android/.test(navigator.userAgent);
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            
            if (isIOS) {
                // –ù–∞ iOS –∏—Å–ø–æ–ª—å–∑—É–µ–º viewport meta –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                const viewport = document.querySelector('meta[name=viewport]');
                const navbar = document.querySelector('.navbar');
                const mobileTopNav = document.querySelector('.mobile-top-nav');
                
                if (body.classList.contains('fullscreen-mode')) {
                    // –í—ã—Ö–æ–¥–∏–º –∏–∑ "–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ" —Ä–µ–∂–∏–º–∞
                    body.classList.remove('fullscreen-mode');
                    if (navbar) navbar.style.display = 'block';
                    if (mobileTopNav) mobileTopNav.style.display = 'block';
                    fullscreenIcon.className = 'bi bi-fullscreen';
                    localStorage.setItem('fullscreen', 'false');
                } else {
                    // –í—Ö–æ–¥–∏–º –≤ "–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π" —Ä–µ–∂–∏–º
                    body.classList.add('fullscreen-mode');
                    if (navbar) navbar.style.display = 'none';
                    if (mobileTopNav) mobileTopNav.style.display = 'none';
                    fullscreenIcon.className = 'bi bi-fullscreen-exit';
                    localStorage.setItem('fullscreen', 'true');
                }
                return;
            }
            
            if (!fullscreenElement) {
                // –í—Ö–æ–¥–∏–º –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
                if (requestFullscreen) {
                    requestFullscreen.call(document.documentElement).then(() => {
                        fullscreenIcon.className = 'bi bi-fullscreen-exit';
                        body.classList.add('fullscreen-mode');
                        localStorage.setItem('fullscreen', 'true');
                        
                        // –î–ª—è Android –¥–æ–±–∞–≤–ª—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
                        if (isAndroid) {
                            // –°–∫—Ä—ã–≤–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é
                            if (navigator.userAgent.includes('Chrome')) {
                                // –î–ª—è Chrome –Ω–∞ Android
                                document.documentElement.style.overflow = 'hidden';
                            }
                        }
                    }).catch(err => {
                        console.log('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º:', err);
                        // –ï—Å–ª–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º CSS-—Ä–µ–∂–∏–º
                        body.classList.add('fullscreen-mode');
                        fullscreenIcon.className = 'bi bi-fullscreen-exit';
                        localStorage.setItem('fullscreen', 'true');
                    });
                } else {
                    // Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                    body.classList.add('fullscreen-mode');
                    fullscreenIcon.className = 'bi bi-fullscreen-exit';
                    localStorage.setItem('fullscreen', 'true');
                }
            } else {
                // –í—ã—Ö–æ–¥–∏–º –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                if (exitFullscreen) {
                    exitFullscreen.call(document).then(() => {
                        fullscreenIcon.className = 'bi bi-fullscreen';
                        body.classList.remove('fullscreen-mode');
                        localStorage.setItem('fullscreen', 'false');
                        
                        if (isAndroid) {
                            document.documentElement.style.overflow = '';
                        }
                    }).catch(err => {
                        console.log('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞:', err);
                        body.classList.remove('fullscreen-mode');
                        fullscreenIcon.className = 'bi bi-fullscreen';
                        localStorage.setItem('fullscreen', 'false');
                    });
                } else {
                    body.classList.remove('fullscreen-mode');
                    fullscreenIcon.className = 'bi bi-fullscreen';
                    localStorage.setItem('fullscreen', 'false');
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        function exitFullscreen() {
            const fullscreenIcon = document.getElementById('fullscreen-icon');
            const body = document.body;
            
            const exitFullscreen = document.exitFullscreen ||
                                  document.webkitExitFullscreen ||
                                  document.mozCancelFullScreen ||
                                  document.msExitFullscreen;
            
            if (document.fullscreenElement || document.webkitFullscreenElement || 
                document.mozFullScreenElement || document.msFullscreenElement) {
                if (exitFullscreen) {
                    exitFullscreen.call(document).then(() => {
                        fullscreenIcon.className = 'bi bi-fullscreen';
                        body.classList.remove('fullscreen-mode');
                        localStorage.setItem('fullscreen', 'false');
                    }).catch(err => {
                        console.log('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞:', err);
                        body.classList.remove('fullscreen-mode');
                        fullscreenIcon.className = 'bi bi-fullscreen';
                        localStorage.setItem('fullscreen', 'false');
                    });
                }
            } else {
                body.classList.remove('fullscreen-mode');
                fullscreenIcon.className = 'bi bi-fullscreen';
                localStorage.setItem('fullscreen', 'false');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        document.addEventListener('fullscreenchange', function() {
            const fullscreenIcon = document.getElementById('fullscreen-icon');
            const body = document.body;
            
            if (document.fullscreenElement || document.webkitFullscreenElement || 
                document.mozFullScreenElement || document.msFullscreenElement) {
                fullscreenIcon.className = 'bi bi-fullscreen-exit';
                body.classList.add('fullscreen-mode');
            } else {
                fullscreenIcon.className = 'bi bi-fullscreen';
                body.classList.remove('fullscreen-mode');
            }
        });

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–∞ Android
        if (/Android/.test(navigator.userAgent)) {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
            let wasFullscreen = localStorage.getItem('fullscreen') === 'true';
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º –ø–æ—Å–ª–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            window.addEventListener('pageshow', function() {
                if (wasFullscreen) {
                    setTimeout(() => {
                        const body = document.body;
                        if (!body.classList.contains('fullscreen-mode')) {
                            body.classList.add('fullscreen-mode');
                            const fullscreenIcon = document.getElementById('fullscreen-icon');
                            if (fullscreenIcon) {
                                fullscreenIcon.className = 'bi bi-fullscreen-exit';
                            }
                        }
                    }, 100);
                }
            });
            
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—ã—Ö–æ–¥ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
            document.addEventListener('focusin', function(e) {
                if (wasFullscreen && !e.target.closest('.fullscreen-indicator')) {
                    e.preventDefault();
                }
            });
        }

        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–º—ã –∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            const savedFullscreen = localStorage.getItem('fullscreen') === 'true';
            const html = document.documentElement;
            const themeIcon = document.getElementById('theme-icon');
            const body = document.body;
            
            html.setAttribute('data-bs-theme', savedTheme);
            themeIcon.className = savedTheme === 'dark' ? 'bi bi-moon-fill' : 'bi bi-sun-fill';
            
            if (savedFullscreen) {
                body.classList.add('fullscreen-mode');
                const fullscreenIcon = document.getElementById('fullscreen-icon');
                if (fullscreenIcon) {
                    fullscreenIcon.className = 'bi bi-fullscreen-exit';
                }
            }
            
            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –º–æ–±–∏–ª—å–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.mobile-top-nav .nav-link, .mobile-nav .nav-link');
            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentPath) {
                    link.classList.add('active');
                }
            });
        });

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑—É–º–∞ –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º —Ç–∞–ø–µ –Ω–∞ iOS
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ –Ω–∞ Android
        if (/Android/.test(navigator.userAgent)) {
            let scrollTimeout;
            document.addEventListener('scroll', function() {
                if (document.body.classList.contains('fullscreen-mode')) {
                    clearTimeout(scrollTimeout);
                    scrollTimeout = setTimeout(() => {
                        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º –µ—Å–ª–∏ –æ–Ω –±—ã–ª –ø–æ—Ç–µ—Ä—è–Ω
                        if (!document.fullscreenElement && !document.webkitFullscreenElement && 
                            !document.mozFullScreenElement && !document.msFullscreenElement) {
                            document.body.classList.add('fullscreen-mode');
                        }
                    }, 100);
                }
            });
        }

        // PWA —Ä–µ–∂–∏–º - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function detectPWA() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω–æ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∫ PWA
            const isPWA = window.matchMedia('(display-mode: standalone)').matches || 
                          window.navigator.standalone === true ||
                          document.referrer.includes('android-app://') ||
                          window.location.search.includes('pwa=true') ||
                          localStorage.getItem('pwa-mode') === 'true';
            
            if (isPWA) {
                console.log('PWA —Ä–µ–∂–∏–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω');
                document.body.classList.add('pwa-mode');
                localStorage.setItem('pwa-mode', 'true');
                
                // –°–∫—Ä—ã–≤–∞–µ–º –¥—É–±–ª–∏—Ä—É—é—â—É—é –∫–Ω–æ–ø–∫—É –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –≤ PWA
                const fullscreenBtn = document.querySelector('button[onclick="toggleFullscreen()"]');
                if (fullscreenBtn) {
                    fullscreenBtn.style.display = 'none';
                    fullscreenBtn.style.visibility = 'hidden';
                    fullscreenBtn.style.opacity = '0';
                    fullscreenBtn.style.width = '0';
                    fullscreenBtn.style.height = '0';
                    fullscreenBtn.style.padding = '0';
                    fullscreenBtn.style.margin = '0';
                    fullscreenBtn.style.border = 'none';
                    fullscreenBtn.style.position = 'absolute';
                    fullscreenBtn.style.left = '-9999px';
                    fullscreenBtn.style.pointerEvents = 'none';
                    fullscreenBtn.classList.add('d-none');
                    fullscreenBtn.setAttribute('aria-hidden', 'true');
                }
                
                // –¢–∞–∫–∂–µ —Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                const fullscreenIndicator = document.querySelector('.fullscreen-indicator');
                if (fullscreenIndicator) {
                    fullscreenIndicator.style.display = 'none';
                    fullscreenIndicator.style.visibility = 'hidden';
                    fullscreenIndicator.style.opacity = '0';
                    fullscreenIndicator.style.width = '0';
                    fullscreenIndicator.style.height = '0';
                    fullscreenIndicator.style.padding = '0';
                    fullscreenIndicator.style.margin = '0';
                    fullscreenIndicator.style.border = 'none';
                    fullscreenIndicator.style.position = 'absolute';
                    fullscreenIndicator.style.left = '-9999px';
                    fullscreenIndicator.style.pointerEvents = 'none';
                    fullscreenIndicator.classList.add('d-none');
                    fullscreenIndicator.setAttribute('aria-hidden', 'true');
                }
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ–º –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º –≤ PWA
                if (!document.body.classList.contains('fullscreen-mode')) {
                    document.body.classList.add('fullscreen-mode');
                    const fullscreenIcon = document.getElementById('fullscreen-icon');
                    if (fullscreenIcon) {
                        fullscreenIcon.className = 'bi bi-fullscreen-exit';
                    }
                    localStorage.setItem('fullscreen', 'true');
                }
                

                
                // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—ã—Ö–æ–¥ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –≤ PWA
                document.addEventListener('fullscreenchange', function() {
                    if (!document.fullscreenElement && !document.webkitFullscreenElement && 
                        !document.mozFullScreenElement && !document.msFullscreenElement) {
                        // –ï—Å–ª–∏ –≤—ã—à–ª–∏ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –Ω–µ–≥–æ
                        setTimeout(() => {
                            if (document.body.classList.contains('pwa-mode')) {
                                document.body.classList.add('fullscreen-mode');
                            }
                        }, 100);
                    }
                });
                
                // –í PWA —Ä–µ–∂–∏–º–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                setTimeout(() => {
                    const barcodeElements = document.querySelectorAll('.barcode-list, .barcode-item, .stats-cards, .card');
                    barcodeElements.forEach(el => {
                        el.style.display = 'block';
                        el.style.visibility = 'visible';
                        el.style.opacity = '1';
                        el.style.maxHeight = 'none';
                        el.style.overflow = 'visible';
                    });
                }, 100);
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                setTimeout(() => {
                    // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –µ—â–µ —Ä–∞–∑
                    const fullscreenBtn = document.querySelector('button[onclick="toggleFullscreen()"]');
                    if (fullscreenBtn) {
                        fullscreenBtn.style.display = 'none';
                        fullscreenBtn.style.visibility = 'hidden';
                        fullscreenBtn.style.opacity = '0';
                        fullscreenBtn.style.width = '0';
                        fullscreenBtn.style.height = '0';
                        fullscreenBtn.style.padding = '0';
                        fullscreenBtn.style.margin = '0';
                        fullscreenBtn.style.border = 'none';
                        fullscreenBtn.style.position = 'absolute';
                        fullscreenBtn.style.left = '-9999px';
                        fullscreenBtn.style.pointerEvents = 'none';
                    }
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –µ—â–µ —Ä–∞–∑
                    const barcodeElements = document.querySelectorAll('.barcode-list, .barcode-item, .stats-cards, .card');
                    barcodeElements.forEach(el => {
                        el.style.display = 'block';
                        el.style.visibility = 'visible';
                        el.style.opacity = '1';
                        el.style.maxHeight = 'none';
                        el.style.overflow = 'visible';
                    });
                }, 500);
                
                // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–∫—Ä—ã—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                function hideFullscreenButton() {
                    const fullscreenBtn = document.querySelector('button[onclick="toggleFullscreen()"]');
                    if (fullscreenBtn) {
                        fullscreenBtn.style.cssText = `
                            display: none !important;
                            visibility: hidden !important;
                            opacity: 0 !important;
                            width: 0 !important;
                            height: 0 !important;
                            padding: 0 !important;
                            margin: 0 !important;
                            border: none !important;
                            position: absolute !important;
                            left: -9999px !important;
                            clip: rect(0, 0, 0, 0) !important;
                            pointer-events: none !important;
                            font-size: 0 !important;
                            line-height: 0 !important;
                        `;
                        fullscreenBtn.classList.add('d-none');
                        fullscreenBtn.setAttribute('aria-hidden', 'true');
                        fullscreenBtn.setAttribute('tabindex', '-1');
                    }
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å–∫—Ä—ã—Ç–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                hideFullscreenButton();
                setTimeout(hideFullscreenButton, 100);
                setTimeout(hideFullscreenButton, 500);
                setTimeout(hideFullscreenButton, 1000);
                setTimeout(hideFullscreenButton, 2000);
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –∏–∑ DOM
                function removeFullscreenButton() {
                    const fullscreenBtn = document.querySelector('button[onclick="toggleFullscreen()"]');
                    if (fullscreenBtn) {
                        fullscreenBtn.remove();
                        console.log('–ö–Ω–æ–ø–∫–∞ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ DOM –≤ PWA —Ä–µ–∂–∏–º–µ');
                    }
                }
                
                // –£–¥–∞–ª—è–µ–º –∫–Ω–æ–ø–∫—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                setTimeout(removeFullscreenButton, 3000);
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                function hideAllFullscreenButtons() {
                    const fullscreenButtons = document.querySelectorAll('button[onclick*="toggleFullscreen"], .theme-toggle[onclick*="toggleFullscreen"]');
                    fullscreenButtons.forEach(btn => {
                        btn.style.cssText = `
                            display: none !important;
                            visibility: hidden !important;
                            opacity: 0 !important;
                            width: 0 !important;
                            height: 0 !important;
                            padding: 0 !important;
                            margin: 0 !important;
                            border: none !important;
                            position: absolute !important;
                            left: -9999px !important;
                            clip: rect(0, 0, 0, 0) !important;
                            pointer-events: none !important;
                            font-size: 0 !important;
                            line-height: 0 !important;
                            z-index: -9999 !important;
                        `;
                        btn.classList.add('d-none');
                        btn.setAttribute('aria-hidden', 'true');
                        btn.setAttribute('tabindex', '-1');
                    });
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                hideAllFullscreenButtons();
                setTimeout(hideAllFullscreenButtons, 100);
                setTimeout(hideAllFullscreenButtons, 500);
                setTimeout(hideAllFullscreenButtons, 1000);
                setTimeout(hideAllFullscreenButtons, 2000);
                setTimeout(hideAllFullscreenButtons, 3000);
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                function removeAllFullscreenButtons() {
                    const fullscreenButtons = document.querySelectorAll('button[onclick*="toggleFullscreen"], .theme-toggle[onclick*="toggleFullscreen"]');
                    fullscreenButtons.forEach(btn => {
                        btn.remove();
                        console.log('–ö–Ω–æ–ø–∫–∞ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ DOM –≤ PWA —Ä–µ–∂–∏–º–µ');
                    });
                }
                
                // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                setTimeout(removeAllFullscreenButtons, 5000);
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                function hideAllFullscreenButtonsAggressive() {
                    const fullscreenButtons = document.querySelectorAll('button[onclick*="toggleFullscreen"], .theme-toggle[onclick*="toggleFullscreen"]');
                    fullscreenButtons.forEach(btn => {
                        // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è
                        btn.style.cssText = `
                            display: none !important;
                            visibility: hidden !important;
                            opacity: 0 !important;
                            width: 0 !important;
                            height: 0 !important;
                            padding: 0 !important;
                            margin: 0 !important;
                            border: none !important;
                            position: absolute !important;
                            left: -9999px !important;
                            clip: rect(0, 0, 0, 0) !important;
                            pointer-events: none !important;
                            font-size: 0 !important;
                            line-height: 0 !important;
                            z-index: -9999 !important;
                            transform: scale(0) !important;
                            transform-origin: center !important;
                        `;
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è
                        btn.classList.add('d-none', 'invisible', 'position-absolute');
                        btn.setAttribute('aria-hidden', 'true');
                        btn.setAttribute('tabindex', '-1');
                        btn.setAttribute('data-hidden', 'true');
                        btn.setAttribute('hidden', 'true');
                        
                        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è
                        btn.style.setProperty('display', 'none', 'important');
                        btn.style.setProperty('visibility', 'hidden', 'important');
                        btn.style.setProperty('opacity', '0', 'important');
                        btn.style.setProperty('width', '0', 'important');
                        btn.style.setProperty('height', '0', 'important');
                        btn.style.setProperty('padding', '0', 'important');
                        btn.style.setProperty('margin', '0', 'important');
                        btn.style.setProperty('border', 'none', 'important');
                        btn.style.setProperty('position', 'absolute', 'important');
                        btn.style.setProperty('left', '-9999px', 'important');
                        btn.style.setProperty('clip', 'rect(0, 0, 0, 0)', 'important');
                        btn.style.setProperty('pointer-events', 'none', 'important');
                        btn.style.setProperty('font-size', '0', 'important');
                        btn.style.setProperty('line-height', '0', 'important');
                        btn.style.setProperty('z-index', '-9999', 'important');
                        btn.style.setProperty('transform', 'scale(0)', 'important');
                        
                        // –í –∫–æ–Ω—Ü–µ —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM
                        setTimeout(() => {
                            if (btn.parentNode) {
                                btn.parentNode.removeChild(btn);
                                console.log('–ö–Ω–æ–ø–∫–∞ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–∞ –∏–∑ DOM –≤ PWA —Ä–µ–∂–∏–º–µ');
                            }
                        }, 100);
                    });
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é —Å–∫—Ä—ã—Ç–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è
                hideAllFullscreenButtonsAggressive();
                setTimeout(hideAllFullscreenButtonsAggressive, 100);
                setTimeout(hideAllFullscreenButtonsAggressive, 500);
                setTimeout(hideAllFullscreenButtonsAggressive, 1000);
                setTimeout(hideAllFullscreenButtonsAggressive, 2000);
                setTimeout(hideAllFullscreenButtonsAggressive, 3000);
                setTimeout(hideAllFullscreenButtonsAggressive, 5000);
                setTimeout(hideAllFullscreenButtonsAggressive, 10000);
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–¥–∞–ª–µ–Ω–∏—è
                function continuousFullscreenButtonRemoval() {
                    const fullscreenButtons = document.querySelectorAll('button[onclick*="toggleFullscreen"], .theme-toggle[onclick*="toggleFullscreen"]');
                    if (fullscreenButtons.length > 0) {
                        fullscreenButtons.forEach(btn => {
                            btn.remove();
                            console.log('–ö–Ω–æ–ø–∫–∞ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —É–¥–∞–ª–µ–Ω–∞ –≤ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ');
                        });
                    }
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
                setInterval(continuousFullscreenButtonRemoval, 2000);
                
                // –î–æ–±–∞–≤–ª—è–µ–º MutationObserver –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ DOM
                const fullscreenButtonObserver = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === 'childList') {
                            mutation.addedNodes.forEach(function(node) {
                                if (node.nodeType === Node.ELEMENT_NODE) {
                                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π —É–∑–µ–ª –∫–Ω–æ–ø–∫–æ–π –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                                    if (node.matches && node.matches('button[onclick*="toggleFullscreen"], .theme-toggle[onclick*="toggleFullscreen"]')) {
                                        node.remove();
                                        console.log('–ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —É–¥–∞–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ MutationObserver');
                                    }
                                    
                                    // –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                                    const fullscreenButtons = node.querySelectorAll ? node.querySelectorAll('button[onclick*="toggleFullscreen"], .theme-toggle[onclick*="toggleFullscreen"]') : [];
                                    fullscreenButtons.forEach(btn => {
                                        btn.remove();
                                        console.log('–î–æ—á–µ—Ä–Ω—è—è –∫–Ω–æ–ø–∫–∞ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —É–¥–∞–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ MutationObserver');
                                    });
                                }
                            });
                        }
                    });
                });
                
                // –ù–∞—á–∏–Ω–∞–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ DOM
                fullscreenButtonObserver.observe(document.body, {
                    childList: true,
                    subtree: true
                });
                
                // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è PWA –Ω–∞—Å—Ç—Ä–æ–µ–∫
                function continuousPWASettings() {
                    if (document.body.classList.contains('pwa-mode')) {
                        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
                        if (!document.body.classList.contains('fullscreen-mode')) {
                            document.body.classList.add('fullscreen-mode');
                        }
                        
                        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                        const fullscreenButtons = document.querySelectorAll('button[onclick*="toggleFullscreen"], .theme-toggle[onclick*="toggleFullscreen"]');
                        fullscreenButtons.forEach(btn => {
                            btn.remove();
                        });
                        
                        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —à—Ç—Ä–∏—Ö–∫–æ–¥–æ–≤
                        const barcodeElements = document.querySelectorAll('.barcode-list, .barcode-item, .stats-cards, .card');
                        barcodeElements.forEach(el => {
                            el.style.cssText = `
                                display: block !important;
                                visibility: visible !important;
                                opacity: 1 !important;
                                max-height: none !important;
                                overflow: visible !important;
                                height: auto !important;
                                min-height: auto !important;
                                clip: auto !important;
                                position: static !important;
                                left: auto !important;
                                top: auto !important;
                                right: auto !important;
                                bottom: auto !important;
                                transform: none !important;
                                filter: none !important;
                                z-index: auto !important;
                                pointer-events: auto !important;
                            `;
                        });
                        

                    }
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PWA –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
                setInterval(continuousPWASettings, 2000);
            } else {
                // –ï—Å–ª–∏ –Ω–µ PWA, —É–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å—ã
                document.body.classList.remove('pwa-mode');
                localStorage.removeItem('pwa-mode');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è PWA —Ä–µ–∂–∏–º–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
        function enablePWAMode() {
            localStorage.setItem('pwa-mode', 'true');
            detectPWA();
            console.log('PWA —Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω –≤—Ä—É—á–Ω—É—é');
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è PWA —Ä–µ–∂–∏–º–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
        function disablePWAMode() {
            localStorage.removeItem('pwa-mode');
            document.body.classList.remove('pwa-mode');
            console.log('PWA —Ä–µ–∂–∏–º –æ—Ç–∫–ª—é—á–µ–Ω –≤—Ä—É—á–Ω—É—é');
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PWA —Ä–µ–∂–∏–º–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            detectPWA();
        });
        
        // –¢–∞–∫–∂–µ –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –∏–∑ —Ñ–æ–Ω–∞)
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                setTimeout(detectPWA, 100);
            }
        });
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PWA —Ä–µ–∂–∏–º–∞ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
        setInterval(detectPWA, 5000);
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è PWA —Ä–µ–∂–∏–º–∞
        function detectPWAAdvanced() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ PWA
            const isPWA = 
                window.matchMedia('(display-mode: standalone)').matches ||
                window.navigator.standalone === true ||
                document.referrer.includes('android-app://') ||
                window.location.search.includes('pwa=true') ||
                localStorage.getItem('pwa-mode') === 'true' ||
                window.location.protocol === 'https:' && window.location.hostname !== 'localhost' ||
                window.navigator.userAgent.includes('Mobile') && window.navigator.userAgent.includes('Safari') ||
                window.navigator.userAgent.includes('Android') && window.navigator.userAgent.includes('Chrome');
            
            if (isPWA) {
                console.log('PWA —Ä–µ–∂–∏–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏');
                document.body.classList.add('pwa-mode');
                localStorage.setItem('pwa-mode', 'true');
                
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º PWA –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                setTimeout(() => {
                    continuousPWASettings();
                    hideAllFullscreenButtonsAggressive();
                }, 100);
            }
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PWA —Ä–µ–∂–∏–º–∞
        setTimeout(detectPWAAdvanced, 2000);
        setInterval(detectPWAAdvanced, 10000);

        // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è PWA —Ä–µ–∂–∏–º–∞ (Ctrl+Shift+P)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'P') {
                e.preventDefault();
                if (document.body.classList.contains('pwa-mode')) {
                    disablePWAMode();
                } else {
                    enablePWAMode();
                }
            }
        });
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>